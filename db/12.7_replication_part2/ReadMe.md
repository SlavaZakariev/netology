## 12.7 Репликация и масштабирование. Часть 2 - Вячеслав Закариев

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;
- активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);
- SAN-кластер.

*Дайте ответ в свободной форме.*

---

### Решение 1

**- активный master-сервер и пассивный репликационный slave-сервер**

Данный метод относят к горизонтальному масштабированию, где есть основной master-сервер принимающий запросы на чтение и запись данных, а также, копия slave-сервер, который принимает запросы на чтение данных. Данный метод увеличивает производительность на чтение, так как разгружает master-сервер, в дополнение обеспечивает хоть и минимальную, но всё же отказоустойчивость за счёт slave-сервера, и случае аварийного падения master-сервера, минимизирует простой доступности сервиса, за счёт того, что не нужно ждать пока будет восстановлена резервная копия master-сервера, достаточно всего лишь сделать переключение роли slave-сервера на роль master-сервера.

**- master-сервер и несколько slave-серверов**

Данный метод, обеспечивает дополнительную производительность за счёт большего количества slave-серверов на запросы на чтение данных. В данном методе есть сложность в настройке общей схемы для обеспечения синхронизации всех slave-серверов, а также возрастает дополнительная нагрузка не сетевую инфраструктуру.
  
**- активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD)**

Данный метод обеспечивает повышенную отказоустойчивость, так как реализация DRBD заключается в зеркальном отображении всего устройства по сети. Что в свою очередь предоставляет пользователю установить в реальном времени зеркальное отображение локального блочного устройства на удаленной машине, в сочетании с контрольным соединением. Данная схема напоминает работу дискового массива, который позволяет пользователю установить в реальном времени по сети зеркалирование локального блочного устройства.

**- SAN-кластер**

Самый производительный и надёжный метод масштабирования, но в то же время сложный и дорогой. Для высоконагруженных систем, требующих доступности 24/7, данный метод является самым подходящим. Преимущество в том, данный метод предоставляет высокую производительность на аппаратном уровне, высокую отказоустойчивость за счёт возможности горячей замены той же аппаратной части и дополнении, данный метод можно построить так, что будет возможность вертикально масштабировать данную схему за счёт подключение дополнительных нод аппаратного части серверных и сетевых устройств. На сегодняшний день, многие ЦОД работают по такой схеме для возможности обеспечение 24/7/365 для своих сервисов.

---

### Задание 2

Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.* 

---

### Решение 2

Мы можем разбить общую БД на отдельные БД - DB Users, DB Books, DB Stores - это будет вертикальный шардинг, 
вторым шагом мы можем, например, большую БД с пользователями разбить на 2 сервера (горизонтальный шардинг) и на 1 сервере оставить id, имя, пароль, почту, адрес, телефон на другом сервере будем хранить историю заказов, посещения, любимые категории, избранные книги, доступ к книгам онлайн. Два сервера будут работать как master-сервера, для повышения производительности можно к первому серверу добавить slave-сервер.

